<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>@ldesign/calendar - 优化功能演示</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      color: white;
      margin-bottom: 30px;
    }
    
    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .header p {
      font-size: 1.2em;
      opacity: 0.9;
    }
    
    .demo-grid {
      display: grid;
      grid-template-columns: 250px 1fr;
      gap: 20px;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }
    
    .sidebar {
      background: #f7f8fa;
      padding: 20px;
      border-right: 1px solid #e0e0e0;
    }
    
    .sidebar h3 {
      font-size: 1.2em;
      margin-bottom: 20px;
      color: #333;
    }
    
    .feature-section {
      margin-bottom: 30px;
    }
    
    .feature-section h4 {
      font-size: 0.9em;
      text-transform: uppercase;
      color: #666;
      margin-bottom: 10px;
      font-weight: 600;
    }
    
    .feature-btn {
      width: 100%;
      padding: 10px;
      margin-bottom: 8px;
      background: white;
      border: 1px solid #ddd;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
    }
    
    .feature-btn:hover {
      background: #667eea;
      color: white;
      border-color: #667eea;
      transform: translateX(5px);
    }
    
    .feature-btn.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }
    
    .calendar-container {
      padding: 20px;
      min-height: 600px;
      position: relative;
    }
    
    .stats-bar {
      background: #f7f8fa;
      padding: 15px 20px;
      border-bottom: 1px solid #e0e0e0;
      display: flex;
      justify-content: space-around;
    }
    
    .stat-item {
      text-align: center;
    }
    
    .stat-value {
      font-size: 1.5em;
      font-weight: bold;
      color: #667eea;
    }
    
    .stat-label {
      font-size: 0.85em;
      color: #666;
      margin-top: 5px;
    }
    
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    .loader {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .feature-tag {
      display: inline-block;
      padding: 2px 8px;
      background: #4caf50;
      color: white;
      border-radius: 12px;
      font-size: 10px;
      margin-left: 5px;
    }
    
    .feature-tag.new {
      background: #ff5722;
    }
    
    .feature-tag.hot {
      background: #ff9800;
    }
    
    #calendar {
      height: 100%;
      min-height: 500px;
    }
    
    .demo-controls {
      padding: 15px;
      background: #fafafa;
      border-top: 1px solid #e0e0e0;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .control-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .control-group label {
      font-size: 14px;
      color: #666;
    }
    
    .control-group select,
    .control-group input {
      padding: 6px 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>📅 @ldesign/calendar</h1>
      <p>企业级日历组件 - 优化功能演示</p>
    </div>
    
    <div class="demo-grid">
      <!-- 侧边栏 -->
      <div class="sidebar">
        <h3>功能演示</h3>
        
        <div class="feature-section">
          <h4>性能优化</h4>
          <button class="feature-btn" onclick="demo.loadManyEvents(100)">
            加载 100 个事件
          </button>
          <button class="feature-btn" onclick="demo.loadManyEvents(1000)">
            加载 1000 个事件
            <span class="feature-tag hot">HOT</span>
          </button>
          <button class="feature-btn" onclick="demo.loadManyEvents(10000)">
            加载 10000 个事件
            <span class="feature-tag new">NEW</span>
          </button>
          <button class="feature-btn" onclick="demo.toggleVirtualScroll()">
            切换虚拟滚动
          </button>
        </div>
        
        <div class="feature-section">
          <h4>时区支持</h4>
          <button class="feature-btn" onclick="demo.setTimezone('Asia/Shanghai')">
            中国时区
          </button>
          <button class="feature-btn" onclick="demo.setTimezone('America/New_York')">
            纽约时区
          </button>
          <button class="feature-btn" onclick="demo.setTimezone('Europe/London')">
            伦敦时区
          </button>
          <button class="feature-btn" onclick="demo.setTimezone('Asia/Tokyo')">
            东京时区
          </button>
        </div>
        
        <div class="feature-section">
          <h4>农历/节日</h4>
          <button class="feature-btn" onclick="demo.toggleLunar()">
            显示/隐藏农历
            <span class="feature-tag new">NEW</span>
          </button>
          <button class="feature-btn" onclick="demo.toggleHolidays()">
            显示/隐藏节假日
          </button>
          <button class="feature-btn" onclick="demo.addCustomHoliday()">
            添加自定义节日
          </button>
        </div>
        
        <div class="feature-section">
          <h4>事件管理</h4>
          <button class="feature-btn" onclick="demo.createRecurringEvent()">
            创建重复事件
          </button>
          <button class="feature-btn" onclick="demo.importEvents()">
            导入事件 (CSV)
          </button>
          <button class="feature-btn" onclick="demo.exportEvents()">
            导出事件 (iCal)
          </button>
          <button class="feature-btn" onclick="demo.searchEvents()">
            搜索事件
            <span class="feature-tag new">NEW</span>
          </button>
        </div>
        
        <div class="feature-section">
          <h4>提醒功能</h4>
          <button class="feature-btn" onclick="demo.enableReminders()">
            启用事件提醒
            <span class="feature-tag new">NEW</span>
          </button>
          <button class="feature-btn" onclick="demo.testReminder()">
            测试提醒
          </button>
        </div>
        
        <div class="feature-section">
          <h4>打印</h4>
          <button class="feature-btn" onclick="demo.printPreview()">
            打印预览
            <span class="feature-tag new">NEW</span>
          </button>
          <button class="feature-btn" onclick="demo.exportPDF()">
            导出 PDF
          </button>
        </div>
        
        <div class="feature-section">
          <h4>清理</h4>
          <button class="feature-btn" onclick="demo.clearEvents()">
            清空所有事件
          </button>
          <button class="feature-btn" onclick="demo.reset()">
            重置日历
          </button>
        </div>
      </div>
      
      <!-- 主内容区 -->
      <div class="main-content">
        <!-- 统计栏 -->
        <div class="stats-bar">
          <div class="stat-item">
            <div class="stat-value" id="stat-events">0</div>
            <div class="stat-label">事件总数</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="stat-performance">0ms</div>
            <div class="stat-label">渲染时间</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="stat-cache">0%</div>
            <div class="stat-label">缓存命中率</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="stat-memory">0MB</div>
            <div class="stat-label">内存使用</div>
          </div>
        </div>
        
        <!-- 日历容器 -->
        <div class="calendar-container">
          <div id="calendar"></div>
          <div class="loading-overlay" id="loading" style="display: none;">
            <div class="loader"></div>
          </div>
        </div>
        
        <!-- 控制栏 -->
        <div class="demo-controls">
          <div class="control-group">
            <label>视图:</label>
            <select onchange="demo.changeView(this.value)">
              <option value="month">月视图</option>
              <option value="week">周视图</option>
              <option value="day">日视图</option>
              <option value="agenda">议程视图</option>
            </select>
          </div>
          <div class="control-group">
            <label>主题:</label>
            <select onchange="demo.changeTheme(this.value)">
              <option value="light">亮色</option>
              <option value="dark">暗色</option>
            </select>
          </div>
          <div class="control-group">
            <label>语言:</label>
            <select onchange="demo.changeLocale(this.value)">
              <option value="zh-CN">中文</option>
              <option value="en-US">English</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    // 模拟导入日历组件
    // import { createCalendar } from '@ldesign/calendar';
    
    // 演示对象
    window.demo = {
      calendar: null,
      virtualScrollEnabled: true,
      lunarEnabled: false,
      holidaysEnabled: true,
      
      // 初始化
      init() {
        this.showLoading();
        
        // 创建日历实例（实际使用时从 @ldesign/calendar 导入）
        console.log('创建日历实例...');
        
        // 模拟日历创建
        setTimeout(() => {
          this.hideLoading();
          this.updateStats();
          console.log('日历初始化完成！');
        }, 500);
      },
      
      // 加载大量事件
      loadManyEvents(count) {
        this.showLoading();
        const startTime = performance.now();
        
        console.log(`生成 ${count} 个事件...`);
        
        const events = [];
        const now = new Date();
        
        for (let i = 0; i < count; i++) {
          const date = new Date(now);
          date.setDate(date.getDate() + Math.floor(i / 10));
          date.setHours(9 + (i % 8));
          
          events.push({
            id: `event-${i}`,
            title: `事件 ${i + 1}`,
            start: date,
            end: new Date(date.getTime() + 3600000),
            color: `hsl(${(i * 137) % 360}, 70%, 50%)`,
          });
        }
        
        // 模拟添加事件
        setTimeout(() => {
          const renderTime = performance.now() - startTime;
          this.hideLoading();
          this.updateStats(count, renderTime);
          console.log(`${count} 个事件加载完成，耗时: ${renderTime.toFixed(2)}ms`);
          
          // 显示提示
          this.showNotification(`成功加载 ${count} 个事件！`);
        }, Math.min(count / 10, 1000));
      },
      
      // 切换虚拟滚动
      toggleVirtualScroll() {
        this.virtualScrollEnabled = !this.virtualScrollEnabled;
        console.log(`虚拟滚动: ${this.virtualScrollEnabled ? '开启' : '关闭'}`);
        this.showNotification(`虚拟滚动已${this.virtualScrollEnabled ? '开启' : '关闭'}`);
      },
      
      // 设置时区
      setTimezone(tz) {
        console.log(`切换时区: ${tz}`);
        this.showNotification(`已切换到 ${tz} 时区`);
      },
      
      // 切换农历
      toggleLunar() {
        this.lunarEnabled = !this.lunarEnabled;
        console.log(`农历显示: ${this.lunarEnabled ? '开启' : '关闭'}`);
        this.showNotification(`农历显示已${this.lunarEnabled ? '开启' : '关闭'}`);
      },
      
      // 切换节假日
      toggleHolidays() {
        this.holidaysEnabled = !this.holidaysEnabled;
        console.log(`节假日显示: ${this.holidaysEnabled ? '开启' : '关闭'}`);
        this.showNotification(`节假日显示已${this.holidaysEnabled ? '开启' : '关闭'}`);
      },
      
      // 添加自定义节日
      addCustomHoliday() {
        const name = prompt('请输入节日名称:', '公司周年庆');
        if (name) {
          console.log(`添加自定义节日: ${name}`);
          this.showNotification(`已添加自定义节日: ${name}`);
        }
      },
      
      // 创建重复事件
      createRecurringEvent() {
        console.log('创建重复事件: 每周一早会');
        this.showNotification('已创建重复事件: 每周一早会');
      },
      
      // 导入事件
      importEvents() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.csv,.ics,.json';
        input.onchange = (e) => {
          const file = e.target.files[0];
          if (file) {
            console.log(`导入文件: ${file.name}`);
            this.showNotification(`正在导入 ${file.name}...`);
          }
        };
        input.click();
      },
      
      // 导出事件
      exportEvents() {
        console.log('导出事件为 iCal 格式');
        this.showNotification('事件已导出为 calendar.ics');
      },
      
      // 搜索事件
      searchEvents() {
        const keyword = prompt('请输入搜索关键词:', '会议');
        if (keyword) {
          console.log(`搜索事件: ${keyword}`);
          this.showNotification(`找到 5 个包含 "${keyword}" 的事件`);
        }
      },
      
      // 启用提醒
      enableReminders() {
        if ('Notification' in window) {
          Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
              console.log('事件提醒已启用');
              this.showNotification('事件提醒已启用');
            }
          });
        }
      },
      
      // 测试提醒
      testReminder() {
        this.showNotification('提醒: 您有一个会议将在15分钟后开始');
        
        if ('Notification' in window && Notification.permission === 'granted') {
          new Notification('会议提醒', {
            body: '您有一个会议将在15分钟后开始',
            icon: '📅',
          });
        }
      },
      
      // 打印预览
      printPreview() {
        console.log('打开打印预览');
        window.print();
      },
      
      // 导出PDF
      exportPDF() {
        console.log('导出为PDF');
        this.showNotification('正在生成PDF...');
      },
      
      // 清空事件
      clearEvents() {
        if (confirm('确定要清空所有事件吗？')) {
          console.log('清空所有事件');
          this.updateStats(0, 0);
          this.showNotification('所有事件已清空');
        }
      },
      
      // 重置
      reset() {
        console.log('重置日历');
        location.reload();
      },
      
      // 改变视图
      changeView(view) {
        console.log(`切换到${view}视图`);
      },
      
      // 改变主题
      changeTheme(theme) {
        document.body.className = theme;
        console.log(`切换到${theme}主题`);
      },
      
      // 改变语言
      changeLocale(locale) {
        console.log(`切换到${locale}语言`);
      },
      
      // 显示加载
      showLoading() {
        document.getElementById('loading').style.display = 'flex';
      },
      
      // 隐藏加载
      hideLoading() {
        document.getElementById('loading').style.display = 'none';
      },
      
      // 更新统计
      updateStats(events = 0, renderTime = 0) {
        document.getElementById('stat-events').textContent = events.toLocaleString();
        document.getElementById('stat-performance').textContent = `${renderTime.toFixed(0)}ms`;
        document.getElementById('stat-cache').textContent = `${Math.min(85 + Math.random() * 10, 95).toFixed(0)}%`;
        
        const memory = (20 + events * 0.01).toFixed(1);
        document.getElementById('stat-memory').textContent = `${memory}MB`;
      },
      
      // 显示通知
      showNotification(message) {
        // 创建通知元素
        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          background: #4caf50;
          color: white;
          padding: 15px 20px;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
          z-index: 10000;
          animation: slideIn 0.3s ease;
          max-width: 300px;
        `;
        notification.textContent = message;
        document.body.appendChild(notification);
        
        // 3秒后移除
        setTimeout(() => {
          notification.style.animation = 'slideOut 0.3s ease';
          setTimeout(() => notification.remove(), 300);
        }, 3000);
      }
    };
    
    // 添加动画样式
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideIn {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      @keyframes slideOut {
        from {
          transform: translateX(0);
          opacity: 1;
        }
        to {
          transform: translateX(100%);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);
    
    // 初始化
    demo.init();
  </script>
</body>
</html>
