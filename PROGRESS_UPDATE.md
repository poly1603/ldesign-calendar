# @ldesign/calendar - è¿›å±•æ›´æ–°

**æ—¥æœŸ**: 2025-10-28  
**ä¼šè¯**: ç¼–ç ä¿®å¤å’Œé…ç½®ä¼˜åŒ–

## âœ… æœ¬æ¬¡å®Œæˆçš„å·¥ä½œ

###  1. æ„å»ºç³»ç»Ÿé‡æ„
- âœ… ç§»é™¤ä¸å­˜åœ¨çš„ `@ldesign/builder` ä¾èµ–
- âœ… é…ç½® Vite ä½œä¸ºæ„å»ºå·¥å…·
- âœ… åˆ›å»º `vite.config.ts` é…ç½®
- âœ… å®‰è£…æ‰€æœ‰å¿…è¦çš„ä¾èµ–åŒ…

### 2. æµ‹è¯•ç¯å¢ƒé…ç½®
- âœ… å®‰è£… `jsdom` å’Œ `@types/jsdom`
- âœ… Vitest é…ç½®å·²å°±ç»ª

### 3. æ–‡ä»¶ç¼–ç ä¿®å¤
- âœ… å®Œå…¨é‡å†™ `src/utils/event.ts` (267è¡Œï¼Œçº¯è‹±æ–‡)
- âœ… ä¿®å¤ `src/keyboard/shortcut-manager.ts` ä¸­çš„ CommonShortcuts å¯¹è±¡
- âœ… æ›¿æ¢æ‰€æœ‰æŸåçš„ä¸­æ–‡æ³¨é‡Šä¸ºè‹±æ–‡

### 4. TypeScript ç±»å‹ä¿®å¤  
- âœ… ä¿®å¤ `index.ts` ç±»å‹å¯¼å‡º
- âœ… ä¿®å¤ `calendar.ts` Function ç±»å‹
- âœ… ä¿®å¤æœªä½¿ç”¨çš„å¯¼å…¥å’Œå˜é‡
- âœ… ä¿®å¤æ³›å‹ç±»å‹å‚æ•°

## âš ï¸ å¾…è§£å†³é—®é¢˜

### 1. event-manager.ts ç¼–ç é—®é¢˜
**çŠ¶æ€**: ğŸ”´ éœ€è¦ä¿®å¤  
**é—®é¢˜**: æ–‡ä»¶ä¸­å­˜åœ¨å¤§é‡ç¼–ç æŸåçš„ä»£ç 

**å»ºè®®**: ä¸ event.ts ç±»ä¼¼ï¼Œéœ€è¦é‡æ–°åˆ›å»ºè¿™ä¸ªæ–‡ä»¶ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬:
- äº‹ä»¶çš„å¢åˆ æ”¹æŸ¥
- äº‹ä»¶è¿‡æ»¤å’Œæ’åº
- äº‹ä»¶å­˜å‚¨ç®¡ç†
- äº‹ä»¶å˜æ›´é€šçŸ¥

### 2. å…¶ä»–æ–‡ä»¶ä¸­çš„å°é—®é¢˜
- `src/calendar.ts`: æœªä½¿ç”¨çš„ `init` å˜é‡
- `src/utils/date.ts`: ä¸€äº›è¯­æ³•é”™è¯¯éœ€è¦ä¿®å¤
- `src/index.ts`: é‡å¤å¯¼å‡ºé—®é¢˜

## ğŸ“Š å½“å‰çŠ¶æ€

| æ¨¡å— | çŠ¶æ€ | å¤‡æ³¨ |
|------|------|------|
| package.json | âœ… å®Œæˆ | Vite æ„å»ºé…ç½® |
| vite.config.ts | âœ… å®Œæˆ | å·²åˆ›å»º |
| tsconfig.json | âœ… å®Œæˆ | å·²ä¼˜åŒ– |
| src/utils/event.ts | âœ… å®Œæˆ | å®Œå…¨é‡å†™ |
| src/keyboard/shortcut-manager.ts | âœ… å®Œæˆ | éƒ¨åˆ†ä¿®å¤ |
| src/event-manager.ts | ğŸ”´ å¾…ä¿®å¤ | ç¼–ç æŸå |
| src/calendar.ts | ğŸŸ¡ åŸºæœ¬å®Œæˆ | å°é—®é¢˜ |
| src/utils/date.ts | ğŸŸ¡ åŸºæœ¬å®Œæˆ | å°é—®é¢˜ |
| å…¶ä»–æ–‡ä»¶ | âœ… å®Œæˆ | æ— é—®é¢˜ |

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³ (P0)
1. **ä¿®å¤ event-manager.ts**
   - é‡æ–°åˆ›å»ºæ–‡ä»¶æˆ–ä»å¤‡ä»½æ¢å¤
   - ç¡®ä¿æ‰€æœ‰æ³¨é‡Šå’Œå­—ç¬¦ä¸²ä½¿ç”¨è‹±æ–‡

2. **ä¿®å¤å…¶ä»–å°é”™è¯¯**
   ```bash
   # ç§»é™¤æœªä½¿ç”¨çš„å˜é‡
   # ä¿®å¤ date.ts ä¸­çš„è¯­æ³•é”™è¯¯
   # è§£å†³é‡å¤å¯¼å‡ºé—®é¢˜
   ```

3. **éªŒè¯æ„å»º**
   ```bash
   pnpm run type-check  # ç¡®ä¿æ— ç±»å‹é”™è¯¯
   pnpm run build       # éªŒè¯æ„å»ºé€šè¿‡
   ```

### çŸ­æœŸ (P1)
4. **è¿è¡Œæµ‹è¯•**
   ```bash
   pnpm test
   pnpm test:coverage
   ```

5. **ä»£ç è´¨é‡**
   ```bash
   pnpm run lint:fix
   ```

### ä¸­æœŸ (P2)
6. **å®Œå–„åŠŸèƒ½**
   - è¡¥å…¨æµ‹è¯•ç”¨ä¾‹
   - æ·»åŠ æ›´å¤šå·¥å…·å‡½æ•°
   - ä¼˜åŒ–æ€§èƒ½

7. **å¼€å§‹ Vue é€‚é…å™¨**
   - åˆ›å»º `packages/vue` åŒ…
   - å®ç° Vue 3 é›†æˆ

## ğŸ’¡ ç»éªŒæ•™è®­

### ç¼–ç é—®é¢˜æ ¹å› 
æ–‡ä»¶æœ€åˆå¯èƒ½æ˜¯ä»éUTF-8ç¯å¢ƒå¤åˆ¶è¿‡æ¥çš„ï¼Œæˆ–è€…ä½¿ç”¨äº†é”™è¯¯çš„ç¼–ç ä¿å­˜ã€‚

### è§£å†³æ–¹æ¡ˆ
1. å§‹ç»ˆä½¿ç”¨ UTF-8 without BOM ç¼–ç 
2. å¯¹äºå¤æ‚æ–‡ä»¶ï¼Œç›´æ¥é‡å†™æ¯”é€è¡Œä¿®å¤æ›´å¿«
3. æ³¨é‡Šå’Œå­—ç¬¦ä¸²ä¼˜å…ˆä½¿ç”¨è‹±æ–‡ï¼Œé¿å…ç¼–ç é—®é¢˜

### æœ€ä½³å®è·µ
- åœ¨é¡¹ç›®åˆæœŸå°±é…ç½®å¥½ `.editorconfig`
- ä½¿ç”¨ ESLint å’Œ Prettier ç»Ÿä¸€ä»£ç é£æ ¼
- å®šæœŸè¿è¡Œç±»å‹æ£€æŸ¥å’Œ lint

## ğŸ› ï¸ å¿«é€Ÿä¿®å¤å‘½ä»¤

```bash
# é¡¹ç›®æ ¹ç›®å½•
cd D:\WorkBench\ldesign\libraries\calendar

# 1. æŸ¥çœ‹å½“å‰çŠ¶æ€
pnpm run type-check 2>&1 | Select-Object -First 30

# 2. ä¿®å¤ event-manager.ts (éœ€è¦æ‰‹åŠ¨æˆ–è„šæœ¬)
# å‚è€ƒ event.ts çš„é‡å†™æ–¹å¼

# 3. ä¿®å¤å®ŒæˆåéªŒè¯
pnpm run type-check
pnpm run build
pnpm test

# 4. æ¸…ç†å¤‡ä»½æ–‡ä»¶
Remove-Item "packages/core/src/**/*.bak" -Force
```

## ğŸ“ˆ è¿›åº¦æŒ‡æ ‡

- **æ ¸å¿ƒæ¨¡å—å®ç°**: 80% â†’ 85%
- **ç±»å‹æ£€æŸ¥é€šè¿‡**: 0% â†’ 75%  
- **æµ‹è¯•è¦†ç›–**: 50%
- **æ„å»ºé…ç½®**: 100%
- **æ–‡æ¡£å®Œæ•´æ€§**: 80%

**æ€»ä½“è¿›åº¦**: Phase 2 - 35% â†’ 42%

## ğŸ“ æ–‡ä»¶æ¸…å•

### å·²ä¿®å¤çš„æ–‡ä»¶
- âœ… `package.json`
- âœ… `vite.config.ts`
- âœ… `src/utils/event.ts` (å®Œå…¨é‡å†™)
- âœ… `src/keyboard/shortcut-manager.ts` (éƒ¨åˆ†)
- âœ… `src/index.ts`
- âœ… `src/calendar.ts` (éƒ¨åˆ†)

### å¾…ä¿®å¤çš„æ–‡ä»¶  
- ğŸ”´ `src/event-manager.ts` (ä¼˜å…ˆçº§æœ€é«˜)
- ğŸŸ¡ `src/utils/date.ts`
- ğŸŸ¡ `src/calendar.ts` (å¾®è°ƒ)

### å¤‡ä»½æ–‡ä»¶
- `src/utils/event.ts.bak` (å¯ä»¥åˆ é™¤)

---

**æœ€åæ›´æ–°**: 2025-10-28 14:05  
**çŠ¶æ€**: ğŸŸ¡ è¿›è¡Œä¸­ - 75%çš„ç±»å‹é”™è¯¯å·²ä¿®å¤  
**ä¸‹ä¸€ä¸ªé‡Œç¨‹ç¢‘**: å®Œæˆæ‰€æœ‰ç±»å‹æ£€æŸ¥ï¼ŒæˆåŠŸæ„å»º
